:root {
    /* Light Theme Fallback */
    --bg-body: #ffffff; --text-main: #0f172a; --text-sub: #64748b;
    --card-border: #e2e8f0; --msg-bg-ai: #f1f5f9; --msg-text-ai: #1e293b;
    --msg-bg-user: #4f46e5; --msg-text-user: #ffffff;
    --input-bg: #f8fafc; --input-border: #e2e8f0; --input-text: #0f172a;
    --input-placeholder: #94a3b8; --input-focus-ring: rgba(79, 70, 229, 0.2);
    --input-focus-border: #6366f1; --btn-mic-bg: #ffffff; --btn-mic-border: #e2e8f0;
    --btn-mic-text: #64748b; --btn-mic-hover-bg: #f8fafc;
    --scrollbar-thumb: #cbd5e1;
}
body.dark, :root.dark {
    /* OLED Dark Theme */
    --bg-body: #000000; --text-main: #ffffff; --text-sub: #a3a3a3;
    --card-border: #262626; --msg-bg-ai: #171717; --msg-text-ai: #e5e5e5;
    --msg-bg-user: #4f46e5; --msg-text-user: #ffffff;
    --input-bg: #171717; --input-border: #262626; --input-text: #ffffff;
    --input-placeholder: #737373; --input-focus-ring: rgba(99, 102, 241, 0.2);
    --input-focus-border: #6366f1; --btn-mic-bg: #171717;
    --btn-mic-border: #262626; --btn-mic-text: #a3a3a3;
    --btn-mic-hover-bg: #262626; --btn-mic-hover-text: #ffffff;
    --scrollbar-thumb: #404040;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
    font-family: 'Inter', sans-serif; background-color: var(--bg-body);
    color: var(--text-main); height: 100vh; width: 100vw;
    overflow: hidden; display: flex; flex-direction: column;
}
.app-window {
    width: 100%; height: 100%; background-color: var(--card-bg);
    display: flex; flex-direction: column; overflow: hidden; position: relative;
}
.window-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 1rem 1.5rem; border-bottom: 1px solid var(--card-border);
}
.window-title { font-weight: 600; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem; }
.status-dot { width: 8px; height: 8px; background-color: #10b981; border-radius: 50%; }

/* Messages */
.messages-container {
    flex: 1; overflow-y: auto; padding: 1.5rem;
    display: flex; flex-direction: column; gap: 1.5rem;
    align-items: center; scroll-behavior: smooth;
}
.messages-content-wrapper { width: 100%; max-width: 48rem; display: flex; flex-direction: column; gap: 1.5rem; }
.message-wrapper { display: flex; width: 100%; animation: fadeIn 0.3s forwards; }
.message-wrapper.ai { justify-content: flex-start; }
.message-wrapper.user { justify-content: flex-end; }
.message-bubble { max-width: 80%; padding: 0.75rem 1rem; border-radius: 1rem; font-size: 0.875rem; line-height: 1.5; }
.message-bubble.ai { background-color: var(--msg-bg-ai); color: var(--msg-text-ai); border-bottom-left-radius: 0.125rem; }
.message-bubble.user { background-color: var(--msg-bg-user); color: var(--msg-text-user); border-bottom-right-radius: 0.125rem; }

/* Input Area */
.input-area { padding: 1rem; border-top: 1px solid var(--card-border); display: flex; justify-content: center; }
.input-container-max-width { width: 100%; max-width: 48rem; }
.input-row { display: flex; align-items: flex-end; gap: 0.75rem; }
.textarea-wrapper { position: relative; flex: 1; }
#chatInput {
    display: block; width: 100%; padding: 0.875rem 3.5rem 0.875rem 1rem;
    background-color: var(--input-bg); border: 1px solid var(--input-border);
    border-radius: 1rem; color: var(--input-text); font-family: inherit; font-size: 1rem;
    resize: none; outline: none; min-height: 52px; max-height: 200px; overflow-y: hidden;
}
#chatInput::placeholder { color: var(--input-placeholder); }
#chatInput:focus { border-color: var(--input-focus-border); box-shadow: 0 0 0 2px var(--input-focus-ring); }
.send-btn {
    position: absolute; right: 0.5rem; bottom: 0.5rem;
    width: 2.5rem; height: 2.5rem; border: none; border-radius: 0.75rem;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; background-color: transparent; color: var(--input-placeholder);
}
.send-btn:not(:disabled) { background-color: #4f46e5; color: white; }
.send-btn:disabled { cursor: not-allowed; }
body.dark .send-btn:disabled { color: #525252; }

/* Mic Button */
.mic-btn {
    flex-shrink: 0; width: 52px; height: 52px; border-radius: 1rem;
    border: 1px solid var(--btn-mic-border); background-color: var(--btn-mic-bg);
    color: var(--btn-mic-text); display: flex; align-items: center; justify-content: center; cursor: pointer;
}
.mic-btn.listening { background-color: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.5); color: #ef4444; animation: pulse 2s infinite; }

.helper-text { margin-top: 0.5rem; text-align: center; }
.helper-text span { font-size: 0.625rem; color: var(--text-sub); }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
.hidden { display: none !important; }
.block { display: block !important; }